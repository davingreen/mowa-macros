{"version":3,"sources":["../../src/auth.js"],"names":["config","Firebase","getMacrosConfig","GOOGLE_CLIENT","tokens","access_token","console","error","authUrl","Google","getAuthUrl","id","secret","redirect","scope","e","googleOauth","code","getToken","setGoogleClientTokens","googleOauthCallback"],"mappings":"qMAGO,WAA6B,CACnC,GAAI,CACH,GAAIA,QAAS,KAAMC,UAASC,eAAT,EAAnB,CACA,GACC,CAAC,CAACF,OAAOG,aAAP,CAAqBC,MAAvB,EACA,CAAC,CAACJ,OAAOG,aAAP,CAAqBC,MAArB,CAA4BC,YAF/B,CAGE,CACDC,QAAQC,KAAR,CACC,sEADD,EAGA,MAAO,MACP,CACD,GAAIC,SAAUC,OAAOC,UAAP,CACbV,OAAOG,aAAP,CAAqBQ,EADR,CAEbX,OAAOG,aAAP,CAAqBS,MAFR,CAGbZ,OAAOG,aAAP,CAAqBU,QAHR,CAIbb,OAAOG,aAAP,CAAqBW,KAJR,CAAd,CAMA,MAAON,QACP,CAAC,MAAOO,CAAP,CAAU,CACXT,QAAQC,KAAR,CAAcQ,CAAd,EACA,MAAO,MACP,CACD,C,iBAvBqBC,Y,gIAwBf,UAAmCC,IAAnC,CAAyC,CAC/C,GAAI,CACH,GAAIjB,QAAS,KAAMC,UAASC,eAAT,EAAnB,CACA,GAAIE,QAAS,KAAMK,QAAOS,QAAP,CAClBlB,OAAOG,aAAP,CAAqBQ,EADH,CAElBX,OAAOG,aAAP,CAAqBS,MAFH,CAGlBZ,OAAOG,aAAP,CAAqBU,QAHH,CAIlBI,IAJkB,CAAnB,CAMA,MAAO,MAAMhB,UAASkB,qBAAT,CAA+Bf,MAA/B,CACb,CAAC,MAAOW,CAAP,CAAU,CACXT,QAAQC,KAAR,CAAcQ,CAAd,EACA,MAAO,MACP,CACD,C,iBAdqBK,oB,6CA3BtB,0C,GAAYnB,S,oCACZ,sC,GAAYQ,O","file":"auth.js","sourcesContent":["import * as Firebase from \"./utils/firebase\"\r\nimport * as Google from \"./utils/google\"\r\n\r\nexport async function googleOauth() {\r\n\ttry {\r\n\t\tlet config = await Firebase.getMacrosConfig()\r\n\t\tif (\r\n\t\t\t!!config.GOOGLE_CLIENT.tokens &&\r\n\t\t\t!!config.GOOGLE_CLIENT.tokens.access_token\r\n\t\t) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"Macros are already authorized. Clear database tokens to reauthorize.\"\r\n\t\t\t)\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tlet authUrl = Google.getAuthUrl(\r\n\t\t\tconfig.GOOGLE_CLIENT.id,\r\n\t\t\tconfig.GOOGLE_CLIENT.secret,\r\n\t\t\tconfig.GOOGLE_CLIENT.redirect,\r\n\t\t\tconfig.GOOGLE_CLIENT.scope\r\n\t\t)\r\n\t\treturn authUrl\r\n\t} catch (e) {\r\n\t\tconsole.error(e)\r\n\t\treturn false\r\n\t}\r\n}\r\nexport async function googleOauthCallback(code) {\r\n\ttry {\r\n\t\tlet config = await Firebase.getMacrosConfig()\r\n\t\tlet tokens = await Google.getToken(\r\n\t\t\tconfig.GOOGLE_CLIENT.id,\r\n\t\t\tconfig.GOOGLE_CLIENT.secret,\r\n\t\t\tconfig.GOOGLE_CLIENT.redirect,\r\n\t\t\tcode\r\n\t\t)\r\n\t\treturn await Firebase.setGoogleClientTokens(tokens)\r\n\t} catch (e) {\r\n\t\tconsole.error(e)\r\n\t\treturn false\r\n\t}\r\n}"]}